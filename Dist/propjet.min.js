/*
 propjet.js 0.2
 (c) 2015 Artem Avramenko. https://github.com/ArtemAvramenko/propjet.js
 License: MIT
*/
this.propjet=(function(){var a=(function(f,g){var d;if(f&&!g){for(g in f){var e=Object.getOwnPropertyDescriptor(f,g);if(e!=null&&e.get!=null){continue}d=f[g];if(d!=null&&d.__prop__unready__){delete d.__prop__unready__;c(g,d)}}return}d={};d.__prop__unready__=true;var b={require:function(){var i=[];for(var h=0;h<arguments.length;h++){i[h-0]=arguments[h]}d.requirements=i;return b},"default":function(h){d.initialResult=h;return b},get:function(h){d.getter=h;return b},set:function(h){d.setter=h;return b},"with":function(h){d.filter=h;return b},declare:function(){if(g){c(g,d)}else{return d}}};return b;function c(j,h){Object.defineProperty(f,j,{configurable:true,enumerable:true,get:i,set:k});function i(){if(h.stage===2){return h.lastResult}if(h.stage===1){throw new Error("Recursive property read")}h.stage=1;try{if(!h.getter){if(h.initialResult){h.lastResult=h.initialResult();h.initialResult=undefined}return h.lastResult}var s=h.lastArgs&&h.lastArgs.length===h.requirements.length;if(!s){h.lastArgs=undefined}var l;if(h.requirements){l=[];for(var n in h.requirements){var m=h.requirements[n];var r=h.lastArgs!=null?h.lastArgs[n]:undefined;var o=m(r!=null?r.value:undefined);l.push(o);if(s){s=r.value===o&&r.__prop__ver__===o.__prop__ver__&&r.length===o.length}}}if(!s){var p;if(l){p=[];l.forEach(function(t){return p.push({value:t,__prop__ver__:t.__prop__ver__,length:t.length})})}var q=h.getter.apply(undefined,l);if(h.filter){q=h.filter(q,h.lastResult)}h.lastArgs=p;h.lastResult=q}return h.lastResult}finally{h.stage=undefined}}function k(l){if(h.stage){throw new Error("Recursive property write")}h.stage=2;try{if(l!=null&&l.__prop__unready__){h=l;delete h.__prop__unready__;return}if(h.filter){l=h.filter(l,h.lastResult)}if(!h.getter){h.lastResult=l;h.initialResult=undefined}if(h.setter){h.setter(l,h.lastResult)}else{if(h.getter){throw new Error("Attempt to write readonly property")}}}finally{h.stage=undefined}}}});a.invalidate=function(d){if(d==null||typeof d!=="object"){return}var e=d.__prop__ver__;if(e!=null){var b=e+1;d.__prop__ver__=b!==e?b:0;return}var c={__prop__ver__:0};Object.defineProperty(d,Object.getOwnPropertyNames(c)[0],{value:1,configurable:true,writable:true})};return a})();