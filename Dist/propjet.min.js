/*!
 propjet.js v1.0.0
 (c) 2015 Artem Avramenko. https://github.com/ArtemAvramenko/propjet.js
 License: MIT
*/
this.propjet=function(){function a(a){throw new Error(["This browser does not support property creation. Instead, use function mode.","Attempt to write readonly property","Circular dependency detected","Recursive property write","Circular promises detected"][a])}function b(){a(1)}function c(a,b,c,d){h(a,b,{configurable:!0,enumerable:!0,get:c,set:d})}function d(a,d,e){c(a,d,function(){return e[d]},b)}function e(a){if(null!=a){var b=typeof a;if("object"===b||"function"===b){var c=l(a),d=0;return null!=c&&(d=c+1,d===c&&(d=1)),m(a,d),d}}}var f,g="__prop__ver__",h=Object.defineProperty,i=Object.getOwnPropertyNames,j=Object.getOwnPropertyDescriptor,k=!(h&&i&&j);f=[].forEach?function(a,b){return a.forEach(b)}:function(a,b){for(var c=a.length,d=0;c>d;d++)b(a[d],d)};var l,m;if(k){var n="propertyIsEnumerable",o={};o[n]=0;for(var p in o);p||(l=function(a){var b=a[n];return b&&b[g]},m=function(a,b){if(!b){var c=a[n];a[n]=function(a){return c(a)}}a[n][g]=b})}else m=function(a,b){b?a.__prop__ver__=b:h(a,g,{value:0,configurable:!1,writable:!0})};l||(l=function(a){return a.__prop__ver__}),m||(m=function(a,b){return a.__prop__ver__=b});var q,r=0,s=function(g,h){function m(a){var b=null!=a&&a.__prop__unready__;return b&&delete a.__prop__unready__,b}function n(a){if(a===q)return 1;if(null==a)return 2;if(0===a.length&&null==l(a)){for(var b in a)return 0;return 3}return"number"==typeof a&&isNaN(a)?4:0}function o(a,b){if(!a.src)return!1;var c=a.vals&&a.vals.length===a.src.length,d=!c;return f(a.src,function(e,f){var h=d?q:a.vals[f],i=e.call(g,null!=h?h.val:q);if(b[f]=i,c){var j=n(h.val),k=n(i);c=j?j===k:!k&&h.val===i&&h.ver===l(i)&&h.len===i.length}}),c}function p(a,b){var c=[];f(b,function(a,b){c[b]={val:a,ver:null!=a?l(a):q,len:null!=a?a.length:q}}),a.vals=c}function s(a){return a.isDeferred?u:t}function t(d,e,f){function h(a){return 0===arguments.length?i():void j(a)}function i(){var b=e.lvl;if(b>0){if(b===r)return e.res;a(2)}r++;try{e.lvl=r;var c=[],d=o(e,c);if(e.get){if(!d){var f=e.get.apply(g,c);e.fltr&&(f=e.fltr.call(g,f,e.res)),e.src&&p(e,c),e.res=f}}else e.init&&(e.src?d||(e.res=e.init.call(g),p(e,c)):(e.res=e.init.call(g),e.init=q));return e.res}finally{r--,e.lvl=b}}function j(c){e.lvl&&a(3),r++;try{if(e.lvl=-1,m(c))return void(e=c);if(e.fltr&&(c=e.fltr.call(g,c,e.res)),e.get)e.set||b();else{if(e.src){var d=[];o(e,d),p(e,d)}else e.init=q;e.res=c}e.set&&e.set.call(g,c)}finally{r--,e.lvl=0}}return f?(d&&(g[d]=h),h):(k&&a(0),void c(g,d,i,j))}function u(h,i,j){function n(a){w.pending=0===a,w.fulfilled=1===a,w.rejected=2===a,w.settled=0!==a}function r(a,b){e(w),b||(w.last=a),w.rejectReason=b?a:q,n(b?1:2)}function s(a){var b=e(i);return a?void f(["then","catch"],function(c,d){a[c](function(a){l(i)===b&&r(a,d)})}):void r(void 0)}function t(a){if(!v){var b=[],c=o(i,b);(!c||a)&&(e(w),p(i,b),u=i.get.apply(g,b),n(0),s(u))}}var u,v,w={};if(w.get=function(b){v&&a(4),v=!0;try{return b&&!w.pending&&t(b),u}finally{v=!1}},w.set=function(c,d){v&&a(4),v=!0;try{i.set||b(),e(w);var f=[];o(i,f),f.unshift(c);var h=i.set.apply(g,f);return d||(w.last=c),s(h),h}finally{v=!1}},r(q),j){var x=function(){return t(),w};return h&&(g[h]=x),x}k&&a(0);var y={};for(var z in w)d(y,z,w);c(g,h,function(){return t(),y},function(a){m(a)?(i=a,r(q)):b()})}var v;if(g&&!h)return k&&a(0),void f(i(g),function(a){var b=j(g,a);b&&b.get||(v=g[a],m(v)&&s(v)(a,v))});v={};var w={from:function(){return v.isDeferred=!0,v.src=[],w},require:function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];return v.src=a,w},get:function(a){return v.get=a,w},set:function(a){return v.set=a,w},declare:function(a){return a?s(v)(h,v,!0):h?void s(v)(h,v):(v.__prop__unready__=!0,v)}};return w["with"]=w.withal=function(a){return v.fltr=a,w},w["default"]=w.defaults=function(a){return v.init=a,w},w};return s.invalidate=e,s}();