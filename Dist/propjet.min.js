/*
 propjet.js 0.8
 (c) 2015 Artem Avramenko. https://github.com/ArtemAvramenko/propjet.js
 License: MIT
*/
this.propjet=(function(){var b;if([].forEach){b=function(h,g){return h.forEach(g)}}else{b=function(k,g){var j=k.length;for(var h=0;h<j;h++){g(k[h],h)}}}var a;if(!(Object.defineProperty&&Object.getOwnPropertyNames&&Object.getOwnPropertyDescriptor)){a=function(){throw new Error("This browser does not support property creation. Instead, use function mode.")}}var c;var f;if(a){if(!(function(){for(var g in {propertyIsEnumerable:null}){return g}})()){c=function(g){var h=g.propertyIsEnumerable;return h&&h.__prop__ver__};f=function(g,i){if(!i){var h=g.propertyIsEnumerable;g.propertyIsEnumerable=function(j){return h(j)}}g.propertyIsEnumerable.__prop__ver__=i}}}else{f=function(g,h){if(!h){Object.defineProperty(g,"__prop__ver__",{value:0,configurable:true,writable:true})}else{g.__prop__ver__=h}}}if(!c){c=function(g){return g.__prop__ver__}}if(!f){f=function(g,h){return g.__prop__ver__=h}}var d=0;var e=(function(j,k){var i;if(j&&!k){if(a){a()}b(Object.getOwnPropertyNames(j),function(m){var l=Object.getOwnPropertyDescriptor(j,m);if(!l||!l.get){i=j[m];if(i!=null&&i.__prop__unready__){h(m,i)}}});return}i={};i.__prop__unready__=true;var g={require:function(){var m=[];for(var l=0;l<arguments.length;l++){m[l-0]=arguments[l]}i.src=m;return g},"default":function(l){i.init=l;return g},get:function(l){i.get=l;return g},set:function(l){i.set=l;return g},declare:function(l){if(l){return h(k,i,true)}if(k){h(k,i)}else{return i}}};g.withal=g["with"]=function(l){i.fltr=l;return g};return g;function h(r,l,o){delete l.__prop__unready__;if(o){var n=function(u){if(arguments.length===0){return q()}t(u)};if(r){j[r]=n}return n}if(a){a()}Object.defineProperty(j,r,{configurable:true,enumerable:true,get:q,set:t});function m(v){if(v===undefined){return 1}if(v==null){return 2}if(v.length===0&&c(v)==null){for(var u in v){return 0}return 3}if(typeof v==="number"&&isNaN(v)){return 4}return 0}function p(u){if(!l.src){return false}var w=l.vals&&l.vals.length===l.src.length;var v=!w;b(l.src,function(C,y){var A=v?undefined:l.vals[y];var x=C.call(j,A!=null?A.val:undefined);u[y]=x;if(w){var B=m(A.val);var z=m(x);if(B){w=B===z}else{w=!z&&A.val===x&&A.ver===c(x)&&A.len===x.length}}});return w}function s(u){var v;if(l.src){v=[];b(u,function(w,x){v[x]={val:w,ver:w!=null?c(w):undefined,len:w!=null?w.length:undefined}})}l.vals=v}function q(){if(l.lvl){if(l.lvl===d){return l.res}throw new Error("Circular dependency detected")}d++;try{l.lvl=d;var u=[];var w=p(u);if(!l.get){if(l.init){if(l.src){if(!w){l.res=l.init.call(j);s(u)}}else{l.res=l.init.call(j);l.init=undefined}}}else{if(!w){var v=l.get.apply(j,u);if(l.fltr){v=l.fltr.call(j,v,l.res)}s(u);l.res=v}}return l.res}finally{d--;delete l.lvl}}function t(v){if(l.lvl){throw new Error("Recursive property write")}d++;try{l.lvl=-1;if(v!=null&&v.__prop__unready__){l=v;delete l.__prop__unready__;return}if(l.fltr){v=l.fltr.call(j,v,l.res)}if(l.set){l.set.call(j,v)}else{if(l.get){throw new Error("Attempt to write readonly property")}}if(!l.get){if(l.src){var u=[];p(u);s(u)}else{l.init=undefined}l.res=v}}finally{d--;delete l.lvl}}}});e.invalidate=function(h){if(h==null){return}var i=typeof h;if(i!=="object"&&i!=="function"){return}var j=c(h);var g=0;if(j!=null){g=j+1;if(g===j){g=1}}f(h,g)};return e})();