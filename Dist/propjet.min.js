/*
 propjet.js 0.4
 (c) 2015 Artem Avramenko. https://github.com/ArtemAvramenko/propjet.js
 License: MIT
*/
this.propjet=(function(){var a=(function(e,f){var d;if(e&&!f){Object.getOwnPropertyNames(e).forEach(function(h){var g=Object.getOwnPropertyDescriptor(e,h);if(!g||!g.get){d=e[h];if(d!=null&&d.__prop__unready__){delete d.__prop__unready__;c(h,d)}}});return}d={};d.__prop__unready__=true;var b={require:function(){var h=[];for(var g=0;g<arguments.length;g++){h[g-0]=arguments[g]}d.requirements=h;return b},"default":function(g){d.initialResult=g;return b},get:function(g){d.getter=g;return b},set:function(g){d.setter=g;return b},"with":function(g){d.filter=g;return b},declare:function(){if(f){c(f,d)}else{return d}}};return b;function c(j,g){Object.defineProperty(e,j,{configurable:true,enumerable:true,get:i,set:k});function h(l){if(l===undefined){return 1}if(l==null){return 2}if(typeof l==="number"&&isNaN(l)){return 3}return 0}function i(){if(g.stage===2){return g.lastResult}if(g.stage===1){throw new Error("Recursive property read")}g.stage=1;try{if(!g.getter){if(g.initialResult){g.lastResult=g.initialResult.call(e);g.initialResult=undefined}return g.lastResult}var u=g.lastArgs&&g.requirements&&g.lastArgs.length===g.requirements.length;if(!u){g.lastArgs=undefined}var l;if(g.requirements){l=[];for(var m in g.requirements){var t=g.requirements[m];var r=g.lastArgs!=null?g.lastArgs[m]:undefined;var n=t(r!=null?r.value:undefined);l.push(n);if(u){var s=h(r.value);var p=h(n);if(!p||p!==s){u=!s&&!p&&r.value===n&&r.__prop__ver__===n.__prop__ver__&&r.length===n.length}}}}if(!u){var o;if(l){o=[];l.forEach(function(v){return o.push({value:v,__prop__ver__:v!=null?v.__prop__ver__:undefined,length:v!=null?v.length:undefined})})}var q=g.getter.apply(e,l);if(g.filter){q=g.filter.call(e,q,g.lastResult)}g.lastArgs=o;g.lastResult=q}return g.lastResult}finally{g.stage=undefined}}function k(l){if(g.stage){throw new Error("Recursive property write")}g.stage=2;try{if(l!=null&&l.__prop__unready__){g=l;delete g.__prop__unready__;return}if(g.filter){l=g.filter.call(e,l,g.lastResult)}if(!g.getter){g.lastResult=l;g.initialResult=undefined}if(g.setter){g.setter.call(e,l,g.lastResult)}else{if(g.getter){throw new Error("Attempt to write readonly property")}}}finally{g.stage=undefined}}}});a.invalidate=function(d){var e=typeof d;if(e!=="object"&&e!=="function"){return}var f=d.__prop__ver__;if(f!=null){var b=f+1;d.__prop__ver__=b!==f?b:0;return}var c={__prop__ver__:0};Object.defineProperty(d,Object.getOwnPropertyNames(c)[0],{value:1,configurable:true,writable:true})};return a})();